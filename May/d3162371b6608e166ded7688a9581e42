Liverpool survived a first-half scare to reach the Champions League final with a 3-2 win at Villarreal on Tuesday that secured a 5-2 aggregate victory after the night had threatened to turn sour for Juergen Klopp's side. The visitors fell 2-0 down with an insipid first-half performance before fighting back with three goals in a 12-minute spell after the break to advance to their third European Cup final in five seasons. The Premier League side had won 2-0 in England but looked in danger of coming unstuck on a rain-soaked pitch in Spain, as the hosts pegged them back with goals from Boulaye Dia and Francis Coquelin. Liverpool, however, came out transformed after half time and goals from Fabinho, Luis Diaz and Sadio Mane sealed the deal, with Villarreal ending the match with 10 men after a late red card for Etienne Capoue. Klopp's side will meet either Real Madrid or Manchester City, who contest the second leg of their semifinal on Wednesday, in the showpiece in Paris on May 28. City lead 4-3 from the first leg. Roared on by their faithful fan base packed into their modest stadium, Villarreal opened the scoring after three minutes with a close-range strike from Dia that was greeted by a chant of “Yes we can!” from the home supporters. Villarreal had been lifeless in the first leg at Anfield, but looked a completely different team as they tore into Liverpool with the same aggressive game that had knocked out Juventus in the last-16 and beaten Bayern Munich in the quarterfinals. Their relentless pressure forced Liverpool into mistakes they do not usually make, with the visitors' passing accuracy of 66% the lowest they have managed in the first half of a game in all competitions this season. Villarreal levelled the tie with a close-range header from Coquelin and looked on the verge of a miracle comeback. Yet Klopp brought Diaz off the bench at the break and the in-form Colombian winger changed the dynamic of the game, finding space and taking advantage of a Villarreal side that seemed to have run out of gas. As the Liverpool pressure mounted, it felt like only a matter of time until they scored and the goal eventually came after a brilliant combination between Fabinho and Mohamed Salah on the right side. The Brazilian midfielder recovered a loose ball close to the Villarreal area, passed two defenders before playing a one-two with the Egyptian. Salah teed him up with a pass between three defenders that left him alone to score with a low, angled shot that went between the legs of Villarreal keeper Geronimo Rulli, who endured a difficult game. Liverpool smelled blood and went for the jugular, led by Diaz who ghosted into the middle of the box to head Trent Alexander-Arnold's cross easily past the goalkeeper in the 67th minute. Seven minutes later Rulli tried to clear a long pass to Mane outside the area and completely missed the ball, leaving the Senegalese forward all alone to tap into the empty net. Capoue, who had a enjoyed a great first half with two assists, was dismissed with five minutes remaining, receiving a second yellow card for a late challenge on Curtis Jones. “The early goal didn't help us, it helped them massively, so we had to dig deep, we had to be very mature. And obviously in the second half, we played outstanding,” Liverpool centre back Virgil van Dijk told BT Sport.